version: '3.8'
services:
  skills-service:
    build: ./skills/service
    container_name: skills-service
    ports:
      - "8080:8080"
    environment:
      - MODEL_CACHE=/models
    volumes:
      - ./skills:/app
      - models_cache:/models
      - /tmp:/tmp
    deploy:
      resources: {}

  stable-video-diffusion:
    build: ./skills/stable-video-diffusion
    container_name: svd-skill
    runtime: nvidia
    deploy: {}
    environment:
      - SVD_MODEL_ID=stabilityai/stable-video-diffusion-img2vid-xt
      - MODEL_CACHE=/models
    volumes:
      - models_cache:/root/.cache/huggingface
      - /tmp:/tmp

  movie-diffusion:
    build: ./skills/movie-diffusion
    container_name: movie-diffusion-skill
    runtime: nvidia
    environment:
      - MOVIEDIFF_MODEL_ID=TencentARC/MovieDiffusion
      - MODEL_CACHE=/models
    volumes:
      - models_cache:/root/.cache/huggingface
      - /tmp:/tmp

  modelscope-t2v:
    build: ./skills/modelscope-t2v
    container_name: modelscope-t2v-skill
    runtime: nvidia
    environment:
      - MODEL_CACHE=/models
    volumes:
      - models_cache:/root/.cache/huggingface
      - /tmp:/tmp

volumes:
  models_cache:
    driver: local
